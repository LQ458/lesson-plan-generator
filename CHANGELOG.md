# 更新日志

## [2.1.0] - 2025-01-27

### 🚀 新功能 - 用户引导和认证系统

#### ✨ 全新功能

- **用户认证系统**: 完整的登录、注册和用户管理功能
  - 支持用户名/邮箱登录
  - 新用户注册功能
  - 游客模式（无需注册即可体验）
  - 密码加密存储
- **Tour引导功能**: 首次使用时的交互式功能引导
  - 新用户自动显示功能介绍
  - 逐步介绍应用核心功能
  - 可跳过的引导流程
  - 支持重新查看引导
- **个人中心**: 完整的用户资料和设置管理
  - 用户信息展示和编辑
  - 主题设置（浅色/深色/跟随系统）
  - 离线模式管理
  - 通知和隐私设置
  - 帮助和支持功能

#### 🎯 引导内容

- **主题切换**: 介绍三种主题模式的使用
- **离线模式**: 说明本地AI模型的优势
- **教案生成**: 智能教案生成功能详解
- **练习推荐**: 分层练习推荐系统介绍
- **错题分析**: 错题模式分析功能说明
- **资料数字化**: OCR文字识别功能演示

#### 📱 用户体验提升

- **智能引导**: 根据用户状态自动触发引导
- **个性化设置**: 用户偏好自动保存和恢复
- **数据持久化**: 使用Hive本地数据库存储用户信息
- **iOS风格设计**: 完全符合Apple设计规范的用户界面

#### 🔧 技术实现

- **新增依赖包**:
  - `showcaseview: ^3.0.0` - 引导功能实现
  - `crypto: ^3.0.3` - 密码加密
  - `lottie: ^3.1.0` - 动画效果支持
- **数据模型扩展**: 
  - 新增User模型和Hive适配器
  - 用户角色管理（教师/学生/管理员/游客）
  - 用户偏好和设置存储
- **服务架构优化**:
  - AuthService - 用户认证和状态管理
  - TourService - 引导功能管理
  - 改进的数据持久化策略

#### 🎨 界面优化

- **导航栏增强**: 添加用户头像入口
- **引导视觉效果**: 高亮显示和工具提示
- **设置界面**: 完整的iOS风格设置页面
- **登录界面**: 优雅的认证流程设计

## [2.0.0] - 2025-01-27

### 🎨 重大 UI 改进 - Apple Design (Cupertino) 实现

#### ✨ 全新设计语言

- **完全重写 UI**: 从 Material Design 转换为 Apple 的 Cupertino Design
- **iOS 原生体验**: 提供与 iOS 应用一致的外观和交互体验
- **设计一致性**: 所有组件都遵循 Apple Human Interface Guidelines

#### 🔄 核心组件转换

- **应用架构**: MaterialApp → CupertinoApp
- **导航系统**: Scaffold + AppBar → CupertinoPageScaffold + CupertinoNavigationBar
- **标签页**: TabBar → CupertinoSegmentedControl
- **输入组件**: TextField → CupertinoTextField
- **按钮系统**: ElevatedButton/OutlinedButton → CupertinoButton.filled/CupertinoButton
- **对话框**: AlertDialog → CupertinoAlertDialog
- **选择器**: DropdownButton → CupertinoActionSheet
- **开关**: Switch → CupertinoSwitch
- **加载指示器**: CircularProgressIndicator → CupertinoActivityIndicator

#### 🎨 视觉设计升级

- **iOS 系统颜色**: 采用完整的 iOS 系统颜色调色板
  - systemBlue (#007AFF), systemGreen (#34C759), systemOrange (#FF9500)
  - 完整的灰色系统 (systemGray - systemGray6)
  - 深色模式专用颜色
- **图标系统**: 全面采用 CupertinoIcons 图标库
- **圆角设计**: 使用 iOS 标准的 8px 圆角
- **阴影效果**: 采用 iOS 风格的轻微阴影
- **间距系统**: 遵循 iOS 设计规范的间距标准

#### 🔧 主题系统重构

- **CupertinoThemeData**: 实现完整的 iOS 主题配置
- **动态主题**: 支持浅色/深色/跟随系统三种模式
- **字体系统**: 使用 iOS 标准的字体层级
- **颜色适配**: 自动适配深色模式的颜色变化

#### 📱 屏幕重新设计

**主屏幕 (HomeScreen)**

- CupertinoNavigationBar 导航栏
- iOS 风格的功能卡片设计
- 每个功能模块使用不同系统颜色标识
- 优化的离线模型状态展示

**错题分析屏幕 (MistakeAnalysisScreen)**

- CupertinoSegmentedControl 分段控制器
- CupertinoSearchTextField 搜索框
- CupertinoActionSheet 筛选器
- iOS 风格的错题卡片布局

**教案生成屏幕 (LessonPlanScreen)**

- 重新设计的表单输入界面
- CupertinoActivityIndicator 加载动画
- iOS 标准的按钮布局和交互

**添加错题屏幕 (AddMistakeScreen)**

- 完全重写为 iOS 风格
- CupertinoActionSheet 选择器
- 优化的表单验证流程

#### 🎯 交互体验优化

- **模态展示**: 使用 showCupertinoModalPopup
- **导航模式**: iOS 标准的导航栏布局
- **反馈机制**: CupertinoAlertDialog 替代 SnackBar
- **触摸反馈**: 符合 iOS 标准的按钮响应

#### 📚 文档和指南

- **设计指南**: 新增`docs/CUPERTINO_DESIGN_GUIDE.md`
- **组件映射**: 详细的 Material 到 Cupertino 组件转换表
- **开发建议**: iOS 风格开发的最佳实践
- **兼容性说明**: 平台兼容性和后向兼容性

#### 🔧 技术改进

- **性能优化**: 使用原生 Cupertino 组件提升渲染性能
- **代码重构**: 清理和优化组件结构
- **类型安全**: 改进类型定义和空安全
- **响应式设计**: 更好的屏幕适配能力

#### 🌟 用户体验提升

- **一致性**: 整个应用的视觉和交互一致性
- **可访问性**: 更好的深色模式支持和对比度
- **直观性**: 符合 iOS 用户习惯的交互模式
- **流畅性**: 更自然的动画和过渡效果

#### 📦 依赖更新

- 保持现有依赖的兼容性
- 充分利用 Flutter 内置的 Cupertino 组件
- 优化包大小和加载性能

### 🔄 向后兼容

- 保留 Material Design 主题配置作为后备
- 数据模型和业务逻辑保持不变
- API 接口和服务层无变化

### 📱 平台支持

- **Web**: 完全支持 Cupertino 风格
- **iOS**: 获得原生 iOS 体验
- **Android**: 提供一致的 iOS 风格体验

## [1.1.1] - 2025-01-27

### 🐛 修复

- **趋势图表数据显示问题**: 修复了趋势图表内容为空的问题
  - 修正了示例数据生成的日期范围，确保在最近 7 天内
  - 添加了备用示例数据，当没有真实数据时显示演示图表
  - 添加了数据重新生成功能，方便用户刷新示例数据
  - 添加了调试信息，便于问题排查

### ✨ 改进

- **用户体验**: 在趋势图表页面添加了"重新生成"按钮
  - 用户可以清空现有数据并生成新的示例数据
  - 改进了按钮布局，导出和重新生成按钮并排显示
  - 添加了确认对话框，防止误操作

## [1.1.0] - 2025-01-27

### 🐛 修复

- **图表溢出问题**: 修复了错题分析页面趋势图表的数据溢出问题

  - 添加了 LayoutBuilder 来动态计算可用空间
  - 实现了柱状图高度的智能限制，防止超出容器边界
  - 增加了最小高度约束，确保有数据时图表可见
  - 添加了阴影效果，提升视觉体验

- **深色模式文本颜色问题**: 修复了错题分析页面在深色模式下的文本显示问题
  - 修复了 TabBar 标签的颜色对比度问题
  - 统一使用主题颜色系统，确保在浅色/深色模式下都有良好的可读性
  - 修复了统计卡片标题和数值的颜色显示
  - 修复了空状态页面的图标和文本颜色

### ✨ 改进

- **图表视觉效果**: 改进了趋势图表的整体设计

  - 增加了图表高度，提供更好的数据展示空间
  - 优化了柱状图的间距和布局
  - 添加了数值标签的固定高度容器，防止布局抖动
  - 改进了日期标签的显示效果

- **主题一致性**: 确保所有文本元素都遵循主题颜色规范
  - 使用`Theme.of(context).colorScheme.onSurface`作为主要文本颜色
  - 使用`Theme.of(context).colorScheme.primary`作为强调色
  - 添加了透明度支持，提供层次感

### 🔧 技术改进

- 使用 LayoutBuilder 实现响应式图表布局
- 添加了数据边界检查，防止除零错误
- 优化了图表渲染性能
- 改进了代码可读性和维护性

## [1.0.0] - 2025-01-26

### 🎉 初始版本

- 教案自动生成功能
- 分层练习推荐
- 错题分析和统计
- 纸质资料数字化（OCR）
- 深色/浅色主题支持
- 响应式设计
- 本地数据存储
 